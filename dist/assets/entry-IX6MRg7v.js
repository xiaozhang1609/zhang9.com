var u=Object.defineProperty;var x=(o,r,t)=>r in o?u(o,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[r]=t;var c=(o,r,t)=>x(o,typeof r!="symbol"?r+"":r,t);import{j as e,r as d,_ as m,$ as p,a0 as f,a1 as g,a2 as b,a3 as w,a4 as y,a5 as j}from"./react-vendor-BKM8yMA-.js";import{c as v,g as N,a as k}from"./system-tools-evrqi1hW.js";import{m as h,A as C}from"./animation-Bh1FUUTH.js";import"./vendor-DDnjVn9r.js";import"./utils-BQ-fc-FY.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function E({isOpen:o,activeTool:r,onToolSelect:t,onHomeClick:i}){return e.jsxs(h.div,{initial:{x:-280},animate:{x:o?0:-280},className:"fixed left-0 top-0 h-full w-70 bg-gradient-to-br from-gray-900 via-indigo-900 to-purple-900 text-white shadow-xl z-[60] grid grid-rows-[auto_1fr_auto]",children:[e.jsx("div",{className:"p-6 border-b border-white/10",children:e.jsxs(h.div,{className:"flex items-center gap-6 cursor-pointer group",onClick:i,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(h.div,{whileHover:{rotate:5},className:"flex items-center justify-center",children:e.jsx("img",{src:"/favicon.svg",alt:"logo",className:"w-12 h-12 transform group-hover:scale-110 transition-transform duration-300"})}),e.jsxs("div",{className:"transform group-hover:translate-x-1 transition-transform duration-300",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-wide bg-gradient-to-r from-white to-white/90 bg-clip-text text-transparent",children:"章九工具箱"}),e.jsx("p",{className:"text-sm text-indigo-200/90 font-medium mt-0.5",children:"提升您的工作效率"})]})]})}),e.jsx("div",{className:"overflow-y-auto scrollbar-hide",children:e.jsx("div",{className:"px-4 py-6",children:Object.entries(v).map(([s,a])=>e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"px-4 text-xs font-medium text-indigo-300/70 uppercase tracking-wider mb-3",children:a}),e.jsx("div",{className:"space-y-1",children:N(s).map(n=>e.jsxs("button",{onClick:()=>t(n.id),className:`w-full px-4 py-2.5 flex items-center gap-3 rounded-lg transition-all duration-200 ${r===n.id?"bg-white/10 text-white":n.isNew?"bg-gradient-to-r from-amber-500/20 to-amber-600/20 hover:from-amber-500/30 hover:to-amber-600/30 text-white":"hover:bg-white/5 text-gray-300 hover:text-white"}`,children:[e.jsx(n.icon,{className:`w-5 h-5 ${r===n.id?"text-indigo-400":n.isNew?"text-amber-400":""}`}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{children:n.name}),n.isNew&&e.jsx("span",{className:"ml-2 px-1.5 py-0.5 text-[10px] bg-amber-500 text-white rounded-full animate-pulse",children:"NEW"})]})]},n.id))})]},s))})})]})}function S(){return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"relative w-16 h-16",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full",children:e.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-indigo-200 border-t-indigo-600 animate-spin"})}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full animate-pulse",children:e.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-transparent border-t-indigo-400 animate-spin-slow"})})]})})}class A extends d.Component{constructor(){super(...arguments);c(this,"state",{hasError:!1,isChunkError:!1});c(this,"reportChunkError",(t,i)=>{console.warn("Chunk loading error reported:",{error:t.message,stack:t.stack,componentStack:i.componentStack,userAgent:navigator.userAgent,url:window.location.href,timestamp:new Date().toISOString()})});c(this,"handleReload",()=>{"caches"in window?caches.keys().then(t=>{t.forEach(i=>{caches.delete(i)}),window.location.reload()}):window.location.reload()});c(this,"handleGoHome",()=>{window.location.href="/"})}static getDerivedStateFromError(t){const i=t.message.includes("Loading chunk")||t.message.includes("Failed to fetch dynamically imported module")||t.message.includes("ChunkLoadError");return{hasError:!0,error:t,isChunkError:i}}componentDidCatch(t,i){var s,a;console.error("ErrorBoundary caught an error:",t,i),this.setState({error:t,errorInfo:i}),(a=(s=this.props).onError)==null||a.call(s,t,i),this.state.isChunkError&&this.reportChunkError(t,i)}render(){var t;return this.state.hasError?this.props.fallback?this.props.fallback:this.state.isChunkError?e.jsx("div",{className:"min-h-[400px] flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-800 dark:to-gray-900",children:e.jsxs("div",{className:"text-center p-8 max-w-md bg-white dark:bg-gray-800 rounded-xl shadow-lg",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-full mb-4",children:e.jsx(m,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"页面需要更新"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6 leading-relaxed",children:"检测到新版本，请刷新页面获取最新功能和修复。"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:this.handleReload,className:"w-full inline-flex items-center justify-center px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium",children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),"刷新页面"]}),e.jsxs("button",{onClick:this.handleGoHome,className:"w-full inline-flex items-center justify-center px-4 py-3 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-colors",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"返回首页"]})]})]})}):e.jsx("div",{className:"min-h-[400px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center p-8 max-w-md",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-4",children:e.jsx(f,{className:"w-8 h-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"出现了一些问题"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:((t=this.state.error)==null?void 0:t.message)||"发生了意外错误"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:this.handleReload,className:"inline-flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),"重新加载"]}),!1]})]})}):this.props.children}}function I(){const[o,r]=d.useState(!1),[t,i]=d.useState("officialWebsiteSearch");d.useEffect(()=>{const a=window.matchMedia("(min-width: 768px)");r(a.matches);const n=l=>{r(l.matches)};return a.addListener(n),()=>a.removeListener(n)},[]);const s=a=>{i(a),window.innerWidth<768&&r(!1)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 transition-colors duration-200",children:[o&&window.innerWidth<768&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm md:hidden z-50",onClick:()=>r(!1)}),e.jsx(E,{isOpen:o,activeTool:t,onToolSelect:s,onHomeClick:()=>s("officialWebsiteSearch")}),!o&&e.jsx("button",{onClick:()=>r(!0),className:"md:hidden fixed top-4 left-4 z-40 p-2.5 bg-white/80 backdrop-blur-md shadow-lg rounded-xl hover:bg-white transition-all duration-200 active:scale-95 border border-gray-100","aria-label":"打开菜单",children:e.jsx(g,{className:"w-5 h-5 text-gray-700"})}),e.jsx("div",{className:`transition-all duration-300 ${o?"ml-0 md:ml-70":"ml-0"}`,children:e.jsx("main",{className:"flex items-center justify-center min-h-screen p-4 md:p-6",children:e.jsx(A,{children:e.jsx(C,{mode:"wait",children:e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},className:"w-full max-w-4xl",children:e.jsx(d.Suspense,{fallback:e.jsx(S,{}),children:(()=>{const a=k(t);return a?b.createElement(a.component,{onToolChange:s}):null})()})},t)})})})})]})}class L{constructor(){c(this,"currentVersion",null);c(this,"checkInterval",null);c(this,"CHECK_INTERVAL",5*60*1e3);this.init()}async init(){this.currentVersion=this.extractVersionFromPage(),this.startPeriodicCheck()}extractVersionFromPage(){try{const t=Array.from(document.querySelectorAll("script[src]")).find(i=>i.src.includes("/assets/index-"));if(t){const i=t.src.match(/index-([a-zA-Z0-9_-]+)\.js/);if(i)return{version:"1.0.0",buildTime:new Date().toISOString(),hash:i[1]}}}catch(r){console.warn("Failed to extract version info:",r)}return null}async checkForUpdates(){try{const r=await fetch(window.location.href,{cache:"no-cache",headers:{"Cache-Control":"no-cache"}});if(!r.ok)return!1;const t=await r.text(),s=new DOMParser().parseFromString(t,"text/html"),n=Array.from(s.querySelectorAll("script[src]")).find(l=>l.src.includes("/assets/index-"));if(n&&this.currentVersion){const l=n.src.match(/index-([a-zA-Z0-9_-]+)\.js/);if(l&&l[1]!==this.currentVersion.hash)return!0}return!1}catch(r){return console.warn("Version check failed:",r),!1}}startPeriodicCheck(){this.checkInterval=window.setInterval(async()=>{await this.checkForUpdates()&&this.notifyUpdate()},this.CHECK_INTERVAL)}notifyUpdate(){var i;const r=document.createElement("div");r.style.cssText=`
      position: fixed;
      top: 20px;
      right: 20px;
      background: #4f46e5;
      color: white;
      padding: 16px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      z-index: 10000;
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 300px;
      animation: slideIn 0.3s ease-out;
    `,r.innerHTML=`
      <div style="display: flex; align-items: center; gap: 12px;">
        <div>
          <div style="font-weight: 600; margin-bottom: 4px;">发现新版本</div>
          <div style="font-size: 14px; opacity: 0.9;">点击刷新获取最新功能</div>
        </div>
        <button id="update-btn" style="
          background: rgba(255, 255, 255, 0.2);
          border: none;
          color: white;
          padding: 6px 12px;
          border-radius: 4px;
          cursor: pointer;
          font-size: 12px;
        ">刷新</button>
      </div>
    `;const t=document.createElement("style");t.textContent=`
      @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
    `,document.head.appendChild(t),document.body.appendChild(r),(i=document.getElementById("update-btn"))==null||i.addEventListener("click",()=>{window.location.reload()}),setTimeout(()=>{r.remove()},1e4)}destroy(){this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)}}new L;w(document.getElementById("root")).render(e.jsx(d.StrictMode,{children:e.jsx(y,{children:e.jsx(j,{children:e.jsx(I,{})})})}));
